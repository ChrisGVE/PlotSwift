# PlotSwift Product Requirements Document - Roadmap

**Date**: 2026-01-17
**Version**: 0.1.0 and beyond
**Context**: Gap analysis and feature roadmap

---

## Executive Summary

PlotSwift currently provides a solid **low-level vector graphics foundation** (DrawingContext, DrawingCommand) with export capabilities (PNG, PDF, SVG). This PRD documents the roadmap to evolve PlotSwift from a drawing library into a full-featured plotting library inspired by matplotlib, seaborn, and manim.

**Current State**: ~820 lines of code providing drawing primitives
**Goal**: Build a high-level plotting API layer on top of the existing foundation

---

## Current PlotSwift Capabilities (v0.1.0)

| Component | Status | Notes |
|-----------|--------|-------|
| **Color** | Complete | RGB, hex, named colors, predefined palette, CGColor conversion |
| **TextStyle** | Complete | Font family, size, weight, color, anchor |
| **LineStyle** | Complete | Solid, dashed, dotted, dash-dot, none |
| **MarkerStyle** | Defined | Enum exists but not rendered |
| **DrawingCommand** | Complete | Path ops, shapes, text, transforms, styles, clipping |
| **DrawingContext** | Complete | Retained-mode graphics, render to CG context |
| **PNG Export** | Complete | Via ImageIO |
| **PDF Export** | Complete | Via CGContext |
| **SVG Export** | Partial | Missing arc-to-path conversion |

---

## Phase 1: Core Plotting (v0.2.x)

**Goal**: Basic plotting capability comparable to simple matplotlib usage

### Task 1.1: Figure/Axes Architecture
**Priority**: Critical
**Description**: Implement the foundational Figure and Axes classes that organize plots.
- Figure class as container for one or more Axes
- Axes class representing a single plot area with data, ticks, labels
- Coordinate system transformation (data coords to pixel coords)
- Basic layout management

### Task 1.2: Line Plot Function - plot()
**Priority**: Critical
**Description**: Implement the most basic plot type - line plots.
- Accept [Double] arrays for x and y data
- Support color, lineStyle, lineWidth parameters
- Support marker parameter for data points
- Auto-compute axis limits from data

### Task 1.3: Scatter Plot Function - scatter()
**Priority**: Critical
**Description**: Implement scatter plots with markers.
- Accept [Double] arrays for x and y data
- Support color, marker, size parameters
- Support per-point colors and sizes (arrays)

### Task 1.4: Axis Configuration
**Priority**: Critical
**Description**: Implement axis labels, titles, limits, ticks, and grid.
- setXLabel(), setYLabel() for axis labels
- setTitle() for plot title
- setXLim(), setYLim() for manual axis limits
- setXTicks(), setYTicks() for tick positions
- grid() for grid lines

### Task 1.5: Legend Support
**Priority**: High
**Description**: Implement basic legend functionality.
- legend() function to create legend
- Automatic label collection from plot calls
- Position options (top, bottom, left, right, etc.)

### Task 1.6: Auto-ranging
**Priority**: High
**Description**: Automatically compute appropriate axis limits from data.
- Compute min/max from all data series
- Add padding for visual comfort
- Handle edge cases (single point, all same values)

### Task 1.7: Basic Color Palettes
**Priority**: High
**Description**: Implement categorical and sequential color palettes.
- Default color cycle for multiple series
- Named palettes (tab10, Set1, viridis, etc.)
- Color interpolation for continuous data

---

## Phase 2: Extended Plot Types (v0.3.x - v0.4.x)

**Goal**: Cover common statistical and categorical visualizations

### Task 2.1: Bar Charts - bar() / barh()
**Priority**: High
**Description**: Vertical and horizontal bar charts.
- Single series and grouped bars
- Stacked bars option
- Error bars support

### Task 2.2: Histograms - hist()
**Priority**: High
**Description**: Histogram plots for distribution visualization.
- Automatic binning
- Manual bin specification
- Density normalization option
- Cumulative option

### Task 2.3: Box Plots - boxplot()
**Priority**: Medium
**Description**: Box-and-whisker plots for distribution comparison.
- Quartile computation
- Outlier detection and display
- Grouped box plots

### Task 2.4: Violin Plots - violinplot()
**Priority**: Medium
**Description**: Violin plots combining box plots with KDE.
- Kernel density estimation
- Split violins for comparison
- Quartile markers

### Task 2.5: Pie Charts - pie()
**Priority**: Medium
**Description**: Pie and donut charts.
- Percentage labels
- Exploded slices
- Donut style (inner radius)

### Task 2.6: Error Bars - errorbar()
**Priority**: Medium
**Description**: Plots with error bars.
- Symmetric and asymmetric errors
- Cap style options
- Combined with line/scatter

### Task 2.7: Area Fills - fill_between()
**Priority**: Medium
**Description**: Filled area between curves.
- Fill between y1 and y2
- Fill to baseline
- Conditional filling (where parameter)

### Task 2.8: Heatmaps - heatmap()
**Priority**: Medium
**Description**: Matrix visualization with color mapping.
- 2D array input
- Colormap support
- Annotations (cell values)
- Colorbar

### Task 2.9: Annotations - annotate()
**Priority**: High
**Description**: Text annotations with arrows.
- Arrow styles
- Connection styles
- Reference lines (axhline, axvline)
- Reference regions (axhspan, axvspan)

---

## Phase 3: Advanced Features (v0.5.x - v0.6.x)

**Goal**: Statistical and multi-plot capabilities

### Task 3.1: Subplots - subplots() / GridSpec
**Priority**: High
**Description**: Multiple plots in a single figure.
- Grid-based subplot creation
- Shared axes options
- GridSpec for complex layouts

### Task 3.2: Full Colormap Support
**Priority**: High
**Description**: Complete colormap infrastructure.
- All matplotlib-style colormaps
- Custom colormap creation
- Colorbar with labels
- Normalization (linear, log, symmetric log)

### Task 3.3: Statistical Plots - KDE, Regression
**Priority**: Medium
**Description**: Statistical visualization functions.
- kdeplot() - kernel density estimation
- regplot() - regression with confidence intervals
- residplot() - residual plots

### Task 3.4: Multi-variable Plots - pairplot / jointplot
**Priority**: Medium
**Description**: Visualize relationships between multiple variables.
- pairplot() - pairwise scatter matrix
- jointplot() - bivariate with marginal distributions

### Task 3.5: Themes and Styles
**Priority**: Medium
**Description**: Named style presets.
- Default theme
- Dark theme
- Publication-ready theme
- Custom theme creation

---

## Phase 4: Animation (v0.7.x+)

**Goal**: Manim-inspired animation capabilities

### Task 4.1: Scene Infrastructure
**Priority**: Medium
**Description**: Animation container and timeline.
- Scene class for managing animations
- Timeline for sequencing
- Frame-based rendering

### Task 4.2: Basic Animations
**Priority**: Medium
**Description**: Core animation types.
- Create - draw-in effect
- FadeIn / FadeOut - opacity transitions
- Transform - morph between objects

### Task 4.3: Animate Syntax
**Priority**: Medium
**Description**: Method chaining for property animations.
- .animate.setFillColor()
- .animate.shift()
- .animate.scale()

### Task 4.4: Video Export
**Priority**: Low
**Description**: Export animations to video formats.
- Frame sequence rendering
- MP4 export (via AVFoundation)
- GIF export

---

## NumericSwift/ArraySwift Integration

All phases should include conditional compilation for sister library integration:

```swift
#if canImport(NumericSwift)
import NumericSwift
// Enhanced statistical functions
#endif

#if canImport(ArraySwift)
import ArraySwift
// NDArray support for data input
#endif
```

---

## Testing Requirements

Each task must include:
1. Unit tests for the new functionality
2. Integration tests with existing components
3. Tests for all four compilation combinations:
   - Standalone
   - With NumericSwift
   - With ArraySwift
   - With both NumericSwift and ArraySwift

---

## Success Criteria

- API feels familiar to matplotlib/seaborn users
- Method chaining provides fluent interface
- Sensible defaults produce good-looking plots
- Performance suitable for large datasets
- Full DocC documentation for all public APIs
